%Totall flux in corona, transition and chrmosphere
%total flux values for driver models where driver amplitude is fixed at
%350m/s for all frequencies and modes

%fluxes calculated using energyperunitareascript

%first index is period column is mode
efluxcoronaavg=zeros(6,4);
efluxtranavg=zeros(6,4);
efluxchromavg=zeros(6,4);

%20,42,90,117
ef1Mm=zeros(6,4);  %20
ef2Mm=zeros(6,4);  %42
ef4Mm=zeros(6,4);  %90
ef5p5Mm=zeros(6,4); %117


%arrays storing flux values for (1,1) (2,2) (3,3) normal modes
% periods(471.4, 235.7, 157.1 )
%first index is period column is mode
efluxcoronaavgnd=zeros(1,3);
efluxtranavgnd=zeros(1,3);
efluxchromavgnd=zeros(1,3);

%20,42,90,117
ef1Mmnd=zeros(1,3);  %20
ef2Mmnd=zeros(1,3);  %42
ef4Mmnd=zeros(1,3);  %90
ef5p5Mmnd=zeros(1,3); %117


%(0,0) mode
efluxcoronaavgnd(:)=[665.303;0 ;0];
efluxtranavgnd(:)=[4.3055e6;0 ;0 ];
efluxchromavgnd(:)=[1.2648e6;0 ;0 ];

%20,42,90,117
ef1Mmnd(:)=[7.2224e4;0 ;0 ];
ef2Mmnd(:)=[432.3633;0 ;0 ];
ef4Mmnd(:)=[0.7576;0 ;0 ];
ef5p5Mmnd(:)=[0.1869;0 ;0 ];


periodvalues=zeros(6,4);
freqvalues=zeros(6,4);
mode=zeros(4);

mode=[0 1 2 3];

%period values for different modes
%periodvalues=zeros(5,4);
periodvalues(:,1)=[30;300; 180; 435.1;179.98;282.84];  %0,0 mode
periodvalues(:,2)=[30;300;180;307.1;127.27;200.0];    %0,1 mode
periodvalues(:,3)=[30;300;180;205.1;84.84;133.33];   %0,2 mode
periodvalues(:,4)=[30;300;180;153.8;63.63;100.0];   %0,3 mode

freqvalues=2*pi./periodvalues;
freqvalues=freqvalues.*1000;
f1=freqvalues(:,1);
f2=freqvalues(:,2);
f3=freqvalues(:,3);
f4=freqvalues(:,4);

%(0,0) mode
efluxcoronaavg(:,1)=[631.2369; 5.9662e4; 5.5733e6 ;3.0037e4 ; 7.8956e6; 7.9381e4];
efluxtranavg(:,1)=[5.6011e4; 1.3652e4; 9.6167e8 ;2.8300e7 ; 9.0611e7;  1.1122e7];
efluxchromavg(:,1)=[3.0578e5; -2.7388e6; 5.2853e7 ;-8.3555e6 ; 1.2814e7; -4.8432e6];

%20,42,90,117
ef1Mm(:,1)=[966.0016; 9.377e4; 3.1342e6 ;1.2418e5 ; 6.2586e6; 1.0498e5 ];
ef2Mm(:,1)=[12.5077; 1.7191e3; 1.5851e5 ;2.2957e3 ; 1.7128e4; 2.118e3 ];
ef4Mm(:,1)=[7.9025; 733.8413; 6.7922e4 ;340.7484 ; 9.8941e3; 975.1936 ];
ef5p5Mm(:,1)=[4.2109; 379.3476; 3.5415e4 ;180.6875 ; 5.1971e3; 517.0635 ];

%(0,1) mode
efluxcoronaavg(:,2)=[29.494901358148860;4.051318147572162e+03 ; 2.297778483240479e+04 ;4.053532620146417e+03 ;3.856218208415547e+04;1.954133195048339e+04 ];
efluxtranavg(:,2)=[ 1.054779756729525e+04; 2.322355043706996e+07; 1.429271898161694e+07 ;1.918490649361231e+07 ; 1.179700680364561e+07; 1.352725674772107e+07];
efluxchromavg(:,2)=[ 3.193638517989970e+05; -7.828691311908537e+04; 1.457402658852436e+07 ;-3.517890547439763e+05 ; 1.406546834883577e+07; 1.151505293805653e+07 ];

%300;180;425.9;307.1;127.27;200.0
%20,42,90,117
ef1Mm(:,2)=[ 1.181937534422132e+03; 2.325498887642353e+05; 6.820495175402486e+05 ;2.299084630407648e+05 ; 3.820877309413052e+05; 5.546153509682965e+05 ];
ef2Mm(:,2)=[2.828189265845708; 2.304140042178029e+03; 2.677864825401096e+03 ;2.169226288639462e+03 ; 2.188604456909034e+03; 1.946719309328360e+03];
ef4Mm(:,2)=[ 0.205509652657564; 11.757607578686622; 1.887405292585208e+02 ;11.919682565831048 ; 3.332258098189356e+02; 1.367391163927973e+02 ];
ef5p5Mm(:,2)=[ 0.078588748582156;4.169455752642226; 76.962911859891240 ;3.944310218862486 ; 1.440542130499308e+02; 51.342157472928310];

%(0,2) mode
efluxcoronaavg(:,3)=[31.551342892733622; 7.114636399189047e+03; 2.192934676898806e+04 ;1.850722543285173e+04 ; 6.652705319929058e+03; 6.574184640968255e+04 ];
efluxtranavg(:,3)=[ 3.166917168136111e+07; 2.261510079321959e+07; 2.173718572374981e+07 ;1.096373006913584e+07 ; 1.329974846984266e+06; 1.505622974793834e+07 ];
efluxchromavg(:,3)=[ 1.516761852906676e+04; 7.384013985141966e+06; 3.983705521896209e+06 ;1.242964460743678e+07 ; 6.312284871119971e+06; 1.450556687395446e+07 ];

%300;180;301.25;205.1;84.84;133.33
%20,42,90,117
ef1Mm(:,3)=[9.956172107625232e+02; 3.760322576876637e+05; 7.441724075866326e+05 ;5.275486045419647e+05 ;9.724618568692198e+04; 4.599962240295626e+05 ];
ef2Mm(:,3)=[2.621743605763687; 3.269349907586470e+03; 3.499636779635483e+03 ;3.183704912315482e+03 ; 2.547995248439194e+02; 2.107198010374638e+03 ];
ef4Mm(:,3)=[0.367814361092569; 42.454595456579500; 7.236398077426835e+02 ;1.808480021747144e+02 ; 83.464570736785930; 8.212728599851757e+02 ];
ef5p5Mm(:,3)=[ 0.263676057608323; 29.592560261755786; 5.032617942871063e+02 ;1.225828746185234e+02 ; 60.0194867834706700; 5.792677648523810e+02 ];




%(0,3) mode
efluxcoronaavg(:,4)=[ 1.099996121221212; 8.971907282486773e+02; 1.277667657562286e+04 ;1.177270633924782e+04 ; 3.692021946494602e+02;3.556102170764067e+03 ];
efluxtranavg(:,4)=[3.110821837047084e+02; 2.904914401505826e+06; 2.690951186770544e+07 ;1.272542853652756e+07 ; 1.965282698014879e+05; 1.551896304136794e+06];
efluxchromavg(:,4)=[4.748622985763176e+04; 1.044195868055844e+07; 2.216691474292787e+07 ;1.803483287362705e+07 ; 3.166768342479758e+06; 9.413352199125048e+06];

%300;180;231.0;153.8;63.63;100.0
%20,42,90,117
ef1Mm(:,4)=[ 3.259072103326768e+020; 3.893404121122640e+05; 8.438982957947100e+05 ;6.379451068678251e+05 ; 2.666037590733403e+04; 1.741670556387822e+05 ];
ef2Mm(:,4)=[ 0.331712474317977; 1.094102897287421e+03; 3.179597693651245e+03 ;1.613759684835975e+03 ; 59.694039130527170; 2.846920054715058e+02];
ef4Mm(:,4)=[ 0.009837085404586; 5.428678716522247; 1.211520263107523e+02 ;1.250109085328079e+02 ; 3.602241966890951; 37.859115707072670];
ef5p5Mm(:,4)=[ 0.004005536685833; 3.065851706439246; 71.413545254839660 ;74.017932812412370 ; 2.065831896382486; 22.092193248971686];

f1=freqvalues(:,1);
f2=freqvalues(:,2);
f3=freqvalues(:,3);
f4=freqvalues(:,4);

efc1=ef5p5Mm(:,1);
efc2=ef5p5Mm(:,2);
efc3=ef5p5Mm(:,3);
efc4=ef5p5Mm(:,4);

a(1)=0.4733;
b(1)=0.3517;
c(1)=-5.105e5;
d(1)=-1.936;
e(1)=7513;
f(1)=3.842e5;

delta=(200-15)/20;
f1fit1=15:delta:200;
fitval1=a(1).*exp(-b(1).*(f1fit1.^2))+c(1).*(f1fit1.^(-0.1))+d(1).*f1fit1.^2+f(1);


a(4)=0.4505;
b(4)=0.08382;
c(4)=-1.534;
d(4)=-6.894e-5;
e(4)=7513;
f(4)=3.621;

f1fit4=15:delta:200;
fitval4=a(4).*exp(-b(4).*(f1fit4.^2))+c(4).*(f1fit4.^(-0.1))+d(4).*f1fit4.^2+f(4);





%plot(periodvalues(1:7,1),ef5p5Mm(1:7,1),'o',periodvalues(1:7,2),ef5p5Mm(1:7,2),'+',periodvalues(1:7,3),ef5p5Mm(1:7,3),'x',periodvalues(1:7,4),ef5p5Mm(1:7,4),'s');
%semilogy(periodvalues(1:6,1),ef5p5Mm(1:6,1),'o',periodvalues(1:6,2),ef5p5Mm(1:6,2),'+',periodvalues(1:6,3),ef5p5Mm(1:6,3),'x',periodvalues(1:6,4),ef5p5Mm(1:6,4),'s');
%semilogy(periodvalues(1:6,1),(efluxcoronaavg(1:6,1)+0.01),'o',periodvalues(1:6,2),(efluxcoronaavg(1:6,2)+0.01),'+',periodvalues(1:6,3),(efluxcoronaavg(1:6,3)+0.01),'x',periodvalues(1:6,4),(efluxcoronaavg(1:6,4)+0.01),'s');

%semilogy(freqvalues(1:6,1),ef5p5Mm(1:6,1),'o',freqvalues(1:6,2),ef5p5Mm(1:6,2),'+',freqvalues(1:6,3),ef5p5Mm(1:6,3),'x',freqvalues(1:6,4),ef5p5Mm(1:6,4),'s');
%loglog(freqvalues(1:6,1),ef5p5Mm(1:6,1),'o',freqvalues(1:6,2),ef5p5Mm(1:6,2),'+',freqvalues(1:6,3),ef5p5Mm(1:6,3),'x',freqvalues(1:6,4),ef5p5Mm(1:6,4),'s');
% plot(log10(freqvalues(1:6,1)),log10(ef5p5Mm(1:6,1)),'o',log10(freqvalues(1:6,2)),log10(ef5p5Mm(1:6,2)),'+',log10(freqvalues(1:6,3)),log10(ef5p5Mm(1:6,3)),'x',log10(freqvalues(1:6,4)),log10(ef5p5Mm(1:6,4)),'s');
% hold on;
% plot(log10(f1fit1),log10(fitval1));
% 
% plot(log10(f1fit4),log10(fitval4));

